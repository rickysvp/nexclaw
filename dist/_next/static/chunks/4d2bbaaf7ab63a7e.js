(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,a)=>{t.exports=e.r(76562)},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},32355,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(46932),r=e.i(88653),l=e.i(98919),i=e.i(70756),o=e.i(12426),n=e.i(69638),d=e.i(63209),c=e.i(7233),x=e.i(27612),m=e.i(56909),g=e.i(52754),h=e.i(71689),u=e.i(43531),p=e.i(37727),y=e.i(18566),b=e.i(41255);function j(){let e=(0,y.useRouter)(),[j,f]=(0,a.useState)(null),[N,w]=(0,a.useState)(null),[v,S]=(0,a.useState)("pin"),[C,k]=(0,a.useState)(null),[A,P]=(0,a.useState)(null),[I,T]=(0,a.useState)(""),[D,H]=(0,a.useState)(""),[O,$]=(0,a.useState)(""),[R,W]=(0,a.useState)(!1),[L,z]=(0,a.useState)(""),[E,_]=(0,a.useState)(""),[B,F]=(0,a.useState)([]),[K,M]=(0,a.useState)(""),[U,X]=(0,a.useState)(""),[q,G]=(0,a.useState)([]),[J,Q]=(0,a.useState)(""),[V,Y]=(0,a.useState)(""),[Z,ee]=(0,a.useState)("");(0,a.useEffect)(()=>{b.mockWallets.length>0&&!j&&f(b.mockWallets[0])},[]),(0,a.useEffect)(()=>{if(j){let e=(0,b.getWalletSecurityRule)(j.id);if(e)w(e),T(e.pinCode||""),z(e.maxAmountPerTx||""),_(e.maxAmountPerDay||""),F(e.whitelistAddresses),G(e.blacklistContracts);else{let e={id:`sr_${j.id}`,walletId:j.id,pinCode:"",maxAmountPerTx:"",maxAmountPerDay:"",whitelistAddresses:[],blacklistContracts:[],securityScore:50,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};w(e),b.mockSecurityRules.push(e),T(""),z(""),_(""),F([]),G([])}$(""),H(""),W(!1)}},[j]);let et=e=>{let t=50;return e.pinCode&&(t+=15),e.maxAmountPerTx&&(t+=10),e.maxAmountPerDay&&(t+=10),e.whitelistAddresses&&e.whitelistAddresses.length>0&&(t+=10),e.blacklistContracts&&e.blacklistContracts.length>0&&(t+=5),Math.min(t,100)},ea=(e,t="success")=>{"success"===t?(k(e),setTimeout(()=>k(null),3e3)):(P(e),setTimeout(()=>P(null),3e3))},es=e=>{let t=b.mockSecurityRules.findIndex(t=>t.id===e.id);-1!==t&&(b.mockSecurityRules[t]=e),w(e),ea("保存成功！")},er=e=>e>=80?{label:"高",color:"text-green-400",bgColor:"bg-green-500/20"}:e>=60?{label:"中",color:"text-yellow-400",bgColor:"bg-yellow-500/20"}:{label:"低",color:"text-red-400",bgColor:"bg-red-500/20"};return(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-950 via-black to-gray-900",children:[(0,t.jsx)("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:(0,t.jsx)("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-orange-500/10 rounded-full blur-3xl animate-pulse"})}),(0,t.jsxs)(r.AnimatePresence,{children:[C&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-4 left-1/2 -trangray-x-1/2 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[(0,t.jsx)(u.Check,{className:"h-5 w-5"}),C]}),A&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-4 left-1/2 -trangray-x-1/2 z-50 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[(0,t.jsx)(p.X,{className:"h-5 w-5"}),A]})]}),(0,t.jsx)("header",{className:"sticky top-0 z-40 bg-gray-950/80 backdrop-blur-md border-b border-gray-800/50",children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(s.motion.button,{onClick:()=>e.push("/dashboard"),className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800/50 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,t.jsx)(h.ArrowLeft,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-r from-orange-500 to-purple-600 flex items-center justify-center",children:(0,t.jsx)(l.Shield,{className:"h-5 w-5 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-white",children:"安全规则"}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:"配置钱包安全设置"})]})]})]}),j&&N&&(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-gray-400 text-sm",children:"安全评分"}),(0,t.jsx)("div",{className:`px-3 py-1 rounded-full ${er(N.securityScore).bgColor}`,children:(0,t.jsxs)("span",{className:`font-bold ${er(N.securityScore).color}`,children:[N.securityScore," - ",er(N.securityScore).label]})})]})]})})}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-8 relative z-10",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,t.jsx)(s.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},className:"lg:col-span-1",children:(0,t.jsxs)("div",{className:"bg-gradient-to-br from-gray-800/50 to-gray-900/50 border border-gray-700/50 rounded-2xl p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-bold mb-4 text-white",children:"选择钱包"}),(0,t.jsx)("div",{className:"space-y-3",children:b.mockWallets.map(e=>(0,t.jsx)(s.motion.button,{onClick:()=>f(e),className:`w-full p-4 rounded-xl border transition-all duration-300 text-left ${j?.id===e.id?"border-orange-500/50 bg-gradient-to-r from-orange-500/10 to-purple-500/10":"border-gray-700/50 hover:border-gray-600/50 bg-gray-900/30"}`,whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-r from-orange-500/20 to-purple-500/20 flex items-center justify-center",children:(0,t.jsx)(g.Wallet,{className:"h-5 w-5 text-orange-400"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-white truncate",children:e.name||`Wallet #${e.id}`}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:e.balance})]})]})},e.id))})]})}),(0,t.jsx)(s.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},className:"lg:col-span-3",children:j?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[{id:"pin",label:"PIN 码",icon:i.Lock},{id:"limits",label:"交易限额",icon:o.DollarSign},{id:"whitelist",label:"白名单",icon:n.CheckCircle},{id:"blacklist",label:"黑名单",icon:d.AlertCircle}].map(e=>(0,t.jsxs)(s.motion.button,{onClick:()=>S(e.id),className:`px-4 py-3 rounded-lg font-medium flex items-center gap-2 transition-all duration-300 whitespace-nowrap ${v===e.id?"bg-gradient-to-r from-orange-500/10 to-purple-500/10 text-white border border-orange-500/30":"bg-gray-800/50 text-gray-400 hover:bg-gray-700/50"}`,whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,t.jsx)(e.icon,{className:"h-4 w-4"}),e.label]},e.id))}),(0,t.jsxs)(r.AnimatePresence,{mode:"wait",children:["pin"===v&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-gradient-to-br from-gray-800/50 to-gray-900/50 border border-gray-700/50 rounded-2xl p-6",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"PIN 码设置"}),(0,t.jsx)("p",{className:"text-gray-400",children:"设置 6 位数字 PIN 码，用于交易确认"})]}),(0,t.jsxs)("div",{className:"space-y-4 max-w-md",children:[N?.pinCode&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:"当前 PIN 码"}),(0,t.jsx)("input",{type:"password",value:O,onChange:e=>$(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"输入当前 PIN 码",maxLength:6,className:"w-full px-4 py-3 rounded-lg bg-gray-900/80 border border-gray-700/50 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500/50 transition-colors font-mono tracking-widest"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:N?.pinCode?"新 PIN 码":"设置 PIN 码"}),(0,t.jsx)("input",{type:"password",value:I,onChange:e=>T(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"6 位数字",maxLength:6,className:"w-full px-4 py-3 rounded-lg bg-gray-900/80 border border-gray-700/50 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500/50 transition-colors font-mono tracking-widest"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:"确认 PIN 码"}),(0,t.jsx)("input",{type:"password",value:D,onChange:e=>H(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"再次输入 PIN 码",maxLength:6,className:"w-full px-4 py-3 rounded-lg bg-gray-900/80 border border-gray-700/50 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500/50 transition-colors font-mono tracking-widest"}),I&&D&&I!==D&&(0,t.jsx)("p",{className:"text-red-400 text-sm mt-2",children:"PIN 码不匹配"})]}),(0,t.jsxs)(s.motion.button,{onClick:()=>{N&&(6!==I.length?ea("PIN 码必须是 6 位数字","error"):I!==D?ea("两次输入的 PIN 码不一致","error"):N.pinCode&&O!==N.pinCode?ea("当前 PIN 码错误","error"):(es({...N,pinCode:I,securityScore:et({...N,pinCode:I}),updatedAt:new Date().toISOString()}),W(!0),$(""),H(""),setTimeout(()=>W(!1),2e3)))},disabled:!I||6!==I.length||I!==D||!!N?.pinCode&&!O,className:"w-full px-6 py-3 rounded-lg bg-gradient-to-r from-orange-500 to-purple-600 text-white font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,t.jsx)(m.Save,{className:"h-5 w-5"}),N?.pinCode?"修改 PIN 码":"设置 PIN 码"]})]})]},"pin"),"limits"===v&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-gradient-to-br from-gray-800/50 to-gray-900/50 border border-gray-700/50 rounded-2xl p-6",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"交易限额"}),(0,t.jsx)("p",{className:"text-gray-400",children:"设置交易金额限制，保护资产安全"})]}),(0,t.jsxs)("div",{className:"space-y-4 max-w-md",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:"单笔交易限额 (ETH)"}),(0,t.jsx)("input",{type:"number",value:L,onChange:e=>z(e.target.value),placeholder:"例如：1.0",step:"0.01",min:"0",className:"w-full px-4 py-3 rounded-lg bg-gray-900/80 border border-gray-700/50 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500/50 transition-colors"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"超过此金额的交易需要额外确认"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-400 mb-2",children:"日累计限额 (ETH)"}),(0,t.jsx)("input",{type:"number",value:E,onChange:e=>_(e.target.value),placeholder:"例如：5.0",step:"0.01",min:"0",className:"w-full px-4 py-3 rounded-lg bg-gray-900/80 border border-gray-700/50 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500/50 transition-colors"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"每日累计交易金额上限"})]}),(0,t.jsxs)(s.motion.button,{onClick:()=>{N&&es({...N,maxAmountPerTx:L||void 0,maxAmountPerDay:E||void 0,securityScore:et({...N,maxAmountPerTx:L,maxAmountPerDay:E}),updatedAt:new Date().toISOString()})},className:"w-full px-6 py-3 rounded-lg bg-gradient-to-r from-orange-500 to-purple-600 text-white font-medium flex items-center justify-center gap-2",whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,t.jsx)(m.Save,{className:"h-5 w-5"}),"保存限额设置"]})]})]},"limits"),"whitelist"===v&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-gradient-to-br from-gray-800/50 to-gray-900/50 border border-gray-700/50 rounded-2xl p-6",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"地址白名单"}),(0,t.jsx)("p",{className:"text-gray-400",children:"添加信任的地址，交易时无需额外确认"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("input",{type:"text",value:U,onChange:e=>X(e.target.value),placeholder:"名称（例如：我的主钱包）",className:"flex-1 px-4 py-3 rounded-lg bg-gray-900/80 border border-gray-700/50 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500/50 transition-colors"}),(0,t.jsx)("input",{type:"text",value:K,onChange:e=>M(e.target.value),placeholder:"0x...",className:"flex-[2] px-4 py-3 rounded-lg bg-gray-900/80 border border-gray-700/50 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500/50 transition-colors font-mono"}),(0,t.jsx)(s.motion.button,{onClick:()=>{if(!K||!U)return;if(!K.match(/^0x[a-fA-F0-9]{40}$/))return void ea("请输入有效的以太坊地址","error");let e=[...B,{id:`wl_${Date.now()}`,address:K,name:U,addedAt:new Date().toISOString()}];F(e),N&&es({...N,whitelistAddresses:e,securityScore:et({...N,whitelistAddresses:e}),updatedAt:new Date().toISOString()}),M(""),X("")},disabled:!K||!U,className:"px-4 py-3 rounded-lg bg-gradient-to-r from-green-500 to-emerald-600 text-white font-medium disabled:opacity-50 disabled:cursor-not-allowed",whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,t.jsx)(c.Plus,{className:"h-5 w-5"})})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[B.map(e=>(0,t.jsxs)(s.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-xl border border-gray-700/30",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-white",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-gray-400 font-mono",children:e.address})]}),(0,t.jsx)(s.motion.button,{onClick:()=>{var t;let a;return t=e.id,void(F(a=B.filter(e=>e.id!==t)),N&&es({...N,whitelistAddresses:a,securityScore:et({...N,whitelistAddresses:a}),updatedAt:new Date().toISOString()}))},className:"p-2 rounded-lg hover:bg-red-500/20 text-red-400 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,t.jsx)(x.Trash2,{className:"h-4 w-4"})})]},e.id)),0===B.length&&(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(n.CheckCircle,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500",children:"暂无白名单地址"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:"添加信任地址可提升安全评分"})]})]})]})]},"whitelist"),"blacklist"===v&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-gradient-to-br from-gray-800/50 to-gray-900/50 border border-gray-700/50 rounded-2xl p-6",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"合约黑名单"}),(0,t.jsx)("p",{className:"text-gray-400",children:"添加可疑合约地址，阻止交互"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,t.jsx)("input",{type:"text",value:V,onChange:e=>Y(e.target.value),placeholder:"名称（例如：钓鱼合约）",className:"px-4 py-3 rounded-lg bg-gray-900/80 border border-gray-700/50 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500/50 transition-colors"}),(0,t.jsx)("input",{type:"text",value:J,onChange:e=>Q(e.target.value),placeholder:"合约地址 0x...",className:"px-4 py-3 rounded-lg bg-gray-900/80 border border-gray-700/50 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500/50 transition-colors font-mono"})]}),(0,t.jsx)("input",{type:"text",value:Z,onChange:e=>ee(e.target.value),placeholder:"原因（可选）",className:"w-full px-4 py-3 rounded-lg bg-gray-900/80 border border-gray-700/50 text-white placeholder-gray-500 focus:outline-none focus:border-orange-500/50 transition-colors"}),(0,t.jsxs)(s.motion.button,{onClick:()=>{if(!J||!V)return;if(!J.match(/^0x[a-fA-F0-9]{40}$/))return void ea("请输入有效的合约地址","error");let e=[...q,{id:`bl_${Date.now()}`,address:J,name:V,reason:Z||void 0,addedAt:new Date().toISOString()}];G(e),N&&es({...N,blacklistContracts:e,securityScore:et({...N,blacklistContracts:e}),updatedAt:new Date().toISOString()}),Q(""),Y(""),ee("")},disabled:!J||!V,className:"w-full px-4 py-3 rounded-lg bg-gradient-to-r from-red-500 to-red-600 text-white font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,t.jsx)(c.Plus,{className:"h-4 w-4"}),"添加到黑名单"]}),(0,t.jsxs)("div",{className:"space-y-3 mt-6",children:[q.map(e=>(0,t.jsxs)(s.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"flex items-center justify-between p-4 bg-red-500/5 rounded-xl border border-red-500/20",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-white",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-gray-400 font-mono",children:e.address}),e.reason&&(0,t.jsx)("p",{className:"text-sm text-red-400 mt-1",children:e.reason})]}),(0,t.jsx)(s.motion.button,{onClick:()=>{var t;let a;return t=e.id,void(G(a=q.filter(e=>e.id!==t)),N&&es({...N,blacklistContracts:a,securityScore:et({...N,blacklistContracts:a}),updatedAt:new Date().toISOString()}))},className:"p-2 rounded-lg hover:bg-red-500/20 text-red-400 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,t.jsx)(x.Trash2,{className:"h-4 w-4"})})]},e.id)),0===q.length&&(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(d.AlertCircle,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500",children:"暂无黑名单合约"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:"添加可疑合约可提升安全评分"})]})]})]})]},"blacklist")]})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-20",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-2xl bg-gray-800 flex items-center justify-center mb-6",children:(0,t.jsx)(g.Wallet,{className:"h-10 w-10 text-gray-600"})}),(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"选择钱包"}),(0,t.jsx)("p",{className:"text-gray-400",children:"请从左侧选择一个钱包来配置安全规则"})]})})]})})]})}e.s(["default",()=>j])}]);